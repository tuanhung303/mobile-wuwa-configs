; ==========================================================================================
;       WuWa Mobile Config - Ultimate Edition v3.4 (Annotated)
;       Target: 120 FPS via Native Frame Generation | Max Quality | Warm Colors
;       Device: Snapdragon 8 Elite / 16GB RAM (RedMagic 11 Pro)
;       v3.4 Changes: Added clean visual enhancements (planar reflections, global lighting,
;                     toon rendering distances, rim lighting, point/spotlight shadows)
;       v3.3 Changes: Added Kuro enhanced character features (hair, cloth, facial, shadows),
;                     lens flare, adjusted green color grading (+1%)
;       v3.2 Changes: Refined color grading (reduced yellow tint, more red bias)
;       v3.1 Changes: Fixed 120 FPS ceiling for native frame gen, added GC optimization,
;                     shader precompile, log suppression, velocity rendering, GPU TAA compute
;       v3 Changes: Anti-ghosting TAA, 2GB texture pool, warm colors
; ==========================================================================================

[SystemSettings]
; --- Stability & Blueprint Logic ---
Blueprint.EnableFrameScripts=1 ; Required for game logic consistency
Blueprint.EnableEvents=1 
Blueprint.EnableEventsBudget=0 ; Disable budget to prevent script hitching on high-end CPUs
Blueprint.EnableFrameScriptsBudget=0
Blueprint.EnablePhysicsBudget=0
Blueprint.EnableVehicles=1
Kuro.Blueprint.EnableGameBudget=0 ; Ensures game logic doesn't skip frames during intense combat
Kuro.Blueprint.EnablePhysics=1
Kuro.Blueprint.EnablePhysicsBudget=0

; --- Anti-Flicker Safeguard (v3.1) ---
; Prevents black/white flickering boxes on some Adreno GPUs
; 0 = Hardware occlusion queries (stable), 1 = HZB system, 2 = Force HZB
r.HZBOcclusion=0

; --- Frame Rate Control (Native Frame Generation - 120 FPS Target) ---
; Native frame gen renders base frames and interpolates to reach t.MaxFPS
; Set ceiling high (120) so frame gen can output full 120 FPS
t.MaxFPS=120 ; [v3.1] Output ceiling for native frame generation
t.MinFPS=45 ; Allows headroom during heavy scenes without aggressive drops
FrameRateLimit=120.0 ; [v3.1] Must match t.MaxFPS for frame gen to work
r.VSync=0 ; Disable VSync; let frame generation handle sync
a.UseSwappyForFramePacing=0 ; DISABLED: Native frame gen handles pacing internally

; --- Lighting Fixes (The "Yellow/Over-Exposed" Fix) ---
r.DefaultFeature.Bloom=1 ; Required for skill VFX
r.BloomQuality=1 ; High quality bloom filter
r.Bloom.Intensity=0.02 ; [DO NOT TOUCH] Reverted to stable sweet spot to prevent blinding skill effects
r.Bloom.Threshold=5.0 ; [DO NOT TOUCH] High threshold prevents haze
r.Bloom.SizeScale=0.005 ; [DO NOT TOUCH] Keeps bloom crisp
r.Mobile.HDR=1 ; Enables high dynamic range for better color depth
r.HDR.EnableHDROutput=1 ; Allows the display to utilize full peak brightness
r.Atmosphere.RayleighScatteringScale=1.0 ; [DO NOT TOUCH] Fixes yellow/orange sky tint
r.Atmosphere.MieScatteringScale=0.8 ; [DO NOT TOUCH] Fixes sun-haze over-exposure
r.Atmosphere.SunLightIntensity=1.0 ; Standard sun intensity to prevent blowout
r.Color.Mid=0.5 ; Ensures neutral midtones
r.SupportAtmosphericFog=0 ; DISABLED: Fog disabled for visual clarity
r.Fog=0
r.VolumetricFog=0

; --- Post-Process Cleanup ---
r.MotionBlurQuality=0 ; DISABLED: Removes blur during fast camera movement
r.SceneColorFringeQuality=0 ; DISABLED: Removes Chromatic Aberration (color bleeding on edges)
r.ChromaticAberrationQuality=0
r.FilmGrain=0 ; DISABLED: Removes noise for a cleaner image

; --- Anti-Aliasing & Upscaling ---
r.DefaultFeature.AntiAliasing=2 ; Enables TAA
r.AntiAliasingMethod=2 ; Temporal Anti-Aliasing (Best for edge stability)
r.PostProcessAAQuality=4 ; High-quality TAA samples (Level 6 causes crashes)
r.TemporalAASamples=8 ; Optimized sample count for 90 FPS
r.TemporalAASharpen=0.2 ; [v3] Reduced to prevent over-sharpening artifacts (ringing on hair/edges)
r.TemporalAA.HistoryScreenPercentage=100 ; Native resolution history (200% causes OOM crashes)
r.TemporalAA.CurrentFrameWeight=0.28 ; [v3] Increased to reduce ghosting during fast combat (higher = less ghost)
r.TemporalAA.Upsampling=1 ; Enables TAA upsampling logic for cleaner edges
r.FidelityFX.FSR.Enabled=True ; Enables AMD FSR for better edge reconstruction
r.FidelityFX.FSR.QualityMode=1 ; Balanced quality for 90 FPS stability

; --- [EXPERIMENTAL v3.1] GPU-Accelerated TAA ---
; Offloads TAA computation to GPU compute pipeline - may improve performance on 8 Elite
; To revert: Comment out or set to 0
r.TemporalAA.MobileUseCompute=1
r.TemporalAA.MobileCatmullRom=1 ; Higher quality interpolation filter

; --- [EXPERIMENTAL v3.1] Velocity Rendering ---
; Improves TAA motion detection for cleaner edges during fast movement
; To revert: Comment out all three lines below
r.Mobile.EnableOutlineVelocity=1
r.Mobile.RenderVelocity=1
r.BasePassOutputsVelocity=1

; --- Shadows (Ultimate Stable) ---
r.ShadowQuality=4 ; Cinematic shadow tier
r.Shadow.CSM.MaxCascades=6 ; [DO NOT TOUCH] Stability sweet spot (Higher causes draw-call crashes)
r.Shadow.CSM.MaxMobileCascades=6 ; [DO NOT TOUCH]
r.Shadow.TransitionScale=1.0 ; Smooths transitions between shadow cascades
r.ShadowProjectionScale=4.0 ; Increases shadow resolution at distance
r.Shadow.MaxCSMResolution=1536 ; [DO NOT TOUCH] High sharpness; 2048 causes VRAM crashes
r.Shadow.DistanceScale=1.5 ; Extends shadow draw distance for environmental objects
r.Shadow.RadiusThreshold=0.0001 ; Ensures small objects (grass/debris) still cast shadows
r.Shadow.AllShadowDrawcallMax=8192 ; Guardrail to prevent GPU driver timeout crashes
r.Shadow.SkeletalMeshLODBias=-1 ; Forces higher quality character shadows
r.Shadow.StaticMeshLODBias=-1 ; Forces higher quality environment shadows

; --- Screen Space Effects (SSR & GI) ---
r.SSR.Quality=4 ; High quality reflections on wet surfaces
r.SSR.MaxRoughness=0.7 ; Increases the range of surfaces that can have reflections
r.SSR.Temporal=1 ; Reduces noise/jitter in reflections
r.SSGI.Enable=1 ; Enables Global Illumination for bounce-lighting depth
r.SSGI.Quality=1 ; Level 1 provides the look with 70% less performance cost than Level 4
r.SSGI.HalfRes=1 ; Optimizes GI rendering for high-end mobile
r.ReflectionCaptureResolution=128 ; High resolution cubemaps for characters

; --- Niagara & VFX ---
fx.Niagara.QualityLevel=2 ; Cinematic VFX (Level 1 is too "flat")
fx.NiagaraKuroTickUpdateTime=0.1 ; Balances VFX smoothness vs CPU overhead
r.Niagara.EmitterViewDistanceScale=5.0 ; Prevents skills from disappearing too early in distance
r.ParticleLightQuality=1 ; Particles cast light on the environment

; --- Kuro Enhanced Character Features (v3.3 - 120fps Enhancement) ---
r.Kuro.HairQuality=2 ; High-quality hair rendering with proper strand shading
r.Kuro.ClothSimulate=1 ; Enable cloth physics simulation for realistic movement
r.Kuro.CharacterClothQuality=2 ; High cloth detail and tessellation
r.Kuro.CharacterShadowQuality=3 ; Enhanced self-shadows on characters
r.Kuro.MobileHairLODBias=0 ; No LOD reduction for hair (full quality at distance)
r.Kuro.MobileClothLODBias=0 ; No LOD reduction for cloth physics
r.KuroMobile.FacialAnimationQuality=2 ; High facial animation quality for cutscenes
r.KuroMobile.SkinCacheQuality=2 ; High skin rendering cache for smooth character rendering
r.Kuro.EnableCharacterLut=1 ; Character-specific color lookup table for better skin tones
r.KuroMobile.LensFlareQuality=3 ; High-quality lens flare effects
Kuro.InteractiveLeavesForceMobilePreview=1 ; Interactive foliage reacts to character movement

; --- Kuro Clean Visual Enhancements (v3.4) ---
r.Kuro.EnablePlanarReflection=1 ; Crisp planar reflections on water/floors
r.Kuro.GlobalLightQuality=4 ; Maximum lighting quality for clean shadows
r.Kuro.ToonOutlineDrawDistanceMobile=2000 ; Character outline visible at distance
r.Kuro.ToonEyeTransparentDrawDistanceMobile=800 ; Eye transparency/sparkle at distance
r.Kuro.ToonFaceShadowMeshDrawDistanceMobile=800 ; Face shadow detail at distance
r.Mobile.CustomDepthForToonRim=1 ; Clean toon rim lighting on characters
r.Mobile.TreeRimLight=1 ; Crisp rim lighting on trees/foliage
r.Mobile.EnableKuroSpotlightsShadow=1 ; Sharp spotlight shadows
r.Shadow.KuroEnablePointLightShadow=1 ; Sharp point light shadows

; --- Water Rendering ---
r.Mobile.WaterQuality=1 ; Enables high-quality water shaders
r.Mobile.WaterSSR=1 ; Enables Screen Space Reflections on water
r.Water.WaterMesh.LODCountBias=2 ; Prevents water mesh from looking low-poly nearby

; --- Streaming & Memory (16GB RAM Optimized) ---
r.TextureStreaming=1 
r.Streaming.PoolSize=2048 ; [v3] 2GB texture pool for 16GB RAM devices - reduces pop-in
r.Streaming.LimitPoolSizeToVRAM=1 ; Ensures it respects physical memory limits
r.Streaming.MaxTempMemoryAllowed=512 ; Increases cache for fast-moving scenes
r.Streaming.Boost=1 ; Prioritizes texture loading to reduce blur
wp.Runtime.KuroRuntimeStreamingRangeOverallScale=1.5 ; Balances world loading distance vs crash risk

; --- Threading & Vulkan ---
r.Vulkan.Enable=1 ; Best API for Snapdragon 8 Elite
r.Vulkan.NumWorkerThreads=6 ; Utilizing 6 Performance cores for parallelism
r.Vulkan.EnableRayQuery=0 ; CRITICAL: Ray Query is experimental and causes instant crashes
r.Vulkan.MaxFrameLatency=2 ; [v3] Native frame gen benefits from 2+ buffered frames
r.Vulkan.EnableBindlessRendering=1 ; [DO NOT TOUCH] Critical performance boost for 8 Elite
r.ShaderPipelineCache.Enabled=1 ; Reduces shader compilation stutters
r.ShaderPipelineCache.ReportFrameTick=1
t.MaxWorkerThreads=6 ; Syncs with Vulkan threads for stability
r.Shaders.FastMath=1 ; Uses faster math operations for Adreno GPUs
r.Shaders.Optimize=1




; --- Enhanced Garbage Collection (v3.1) ---
; Multi-threaded, incremental GC for smoother frame times during long sessions
gc.IncrementalReachabilityTimeLimit=0.005 ; Prevents 1ms GC hitches during combat
gc.TimeBetweenPurgingPendingKillObjects=60.0 ; Faster cleanup of deleted objects to save RAM
gc.AllowIncrementalReachability=1 ; Spreads reachability work across frames
gc.AllowIncrementalGather=1 ; Spreads gather work across frames
gc.IncrementalGCTimePerFrame=0.001 ; Limit GC time per frame
gc.AllowParallelGC=1 ; Multi-core GC reduces hitching
gc.ContinuousIncrementalGC=1 ; Spreads GC work continuously
gc.MultithreadedDestructionEnabled=1 ; Faster object cleanup on multiple cores
gc.ActorClusteringEnabled=1 ; Groups related actors for efficient cleanup
gc.AssetClusteringEnabled=1 ; Groups related assets for efficient cleanup
gc.BlueprintClusteringEnabled=1 ; Groups blueprint objects for efficient cleanup
gc.CreateGCClusters=1 ; Enable GC clustering system
gc.MinGCClusterSize=5 ; Minimum cluster size for efficiency
gc.PendingKillEnabled=1 ; Standard pending kill behavior
gc.NumRetriesBeforeForcingGC=10 ; Retries before forcing full GC
gc.MaxObjectsNotConsideredByGC=200 ; Small objects threshold
gc.SizeOfPermanentObjectPool=2097152 ; 2MB permanent object pool

[/Script/Engine.RendererSettings]
r.EarlyZPass=3 ; Optimizes depth rendering
r.EarlyZPassMovable=1
r.Mobile.HDR=1
r.MaterialQualityLevel=1 ; Forces High material shaders
r.DetailMode=2 ; Enables all high-detail decorative objects
r.Tonemapper.Quality=3 ; Highest stable tonemapper logic
r.Tonemapper.Sharpen=0.8 ; [DO NOT TOUCH] Reverted to 0.8 for optimal mobile PPI balance
r.EyeAdaptation.PreExposureOverride=0.9 ; [DO NOT TOUCH] Compensation to prevent blowout
r.AmbientOcclusionLevels=3 ; Enhances contact shadows in corners/foliage
r.AmbientOcclusionMaxQuality=100 ; Ensures crisp contact shadows
r.ViewDistanceScale=4.0 ; [DO NOT TOUCH] Cinematic draw distance for mountains/buildings
r.Shadow.DepthBias=0.03 ; Prevents shadow acne
r.Shadow.SlopeDepthBias=0.04
r.Foliage.ContactShadows=1 ; Adds depth to grass/bushes
r.LightShafts=1 ; Enables god rays for cinematic atmosphere
r.LightShaftQuality=1
r.Mobile.SceneColorFormat=3 ; [DO NOT TOUCH] Float16 for better gradients (8 Elite stable)

; --- Color Balance (Warm Color Enhancement - v3.3 Refined) ---
r.TonemapperFilm=1 ; Filmic tonemapper - preserves warm highlights (orange/red/pink)
r.TonemapperGamma=2.2 ; Standard sRGB gamma curve
r.Color.Gain.R=1.02 ; [v3.4] Red boost (+2%, reduced from +3%)
r.Color.Gain.G=0.95 ; [v3.3] Adjusted green (-5% from neutral, +1% from v3.2)
r.Color.Gain.B=1.0 ; Standard blue (neutral)

; ==========================================================================================
;       STREAMING SETTINGS (v3.1)
; ==========================================================================================
[/Script/Engine.StreamingSettings]
r.TextureStreaming=1
r.Streaming.Boost=1.25 ; Moderate boost to prioritize visible textures
r.Streaming.FullyLoadUsedTextures=0 ; Stream textures instead of forcing full load
r.Streaming.UseAsyncRequestsForDDC=1 ; Async requests prevent stalls
r.Streaming.UseBackgroundThreadPool=1 ; Background thread pool for streaming
r.Streaming.MinBoost=1.0 ; Keep min boost reasonable
r.Streaming.PoolSize=2048 ; 2GB streaming pool for 16GB RAM devices
r.Streaming.UseFixedPoolSize=1 ; Fixed pool size for stability
r.Streaming.UseMaterialData=1 ; Optimize streaming decisions with material data
r.Streaming.UseNewMetrics=1 ; Better quality/performance balance
r.Streaming.UsePerTextureBias=1 ; Per-texture biasing for memory optimization
s.AsyncLoadingThreadEnabled=1
s.EventDrivenLoaderEnabled=1 ; Async streaming
s.WarnIfTimeLimitExceeded=0 ; Disable warnings for cleaner logs
s.UseBackgroundLevelStreaming=1 ; Eliminates stalls
s.LevelStreamingActorsUpdateTimeLimit=5.0 ; Limit update time per frame
s.PriorityLevelStreamingActorsUpdateExtraTime=5.0
s.LevelStreamingComponentsRegistrationGranularity=5
s.UnregisterComponentsTimeLimit=1.0 ; Lower to eliminate long unregister spikes
s.LevelStreamingComponentsUnregistrationGranularity=2
s.FlushStreamingOnExit=1
s.AsyncLoadingTimeLimit=2.0 ; Reduce async loading time budget for smoothness

; ==========================================================================================
;       SHADER PRECOMPILATION (v3.1) - Reduces First-Time Stuttering
; ==========================================================================================
[DevOptions.Shaders]
bAllowPrecompiledShaders=True
bCompilePreloadShaders=True
bForcePrecompiledShaders=True
bPrecompileVisibleShadersForRendering=True
bPreloadAllShaders=True
bPreloadShaderCacheOnDemand=True
bPreloadShadersOnDemand=True
bUsePrecompiledShaders=True
bWaitForShaderCompilation=True

; ==========================================================================================
;       ANDROID RUNTIME SETTINGS (v3.1)
; ==========================================================================================
[/Script/AndroidRuntimeSettings.AndroidRuntimeSettings]
a.UseSwappyForFramePacing=0 ; DISABLED: Native frame gen handles pacing internally
bEnableDynamicMaxFPS=True ; [v3.1] ENABLED: Allows native frame gen to dynamically adjust FPS
bSupportsVulkanSM5=True
r.VSync=0
rhi.SyncInterval=0

; ==========================================================================================
;       CONSOLE VARIABLES (v3.1)
; ==========================================================================================
[ConsoleVariables]
t.MaxWorkerThreads=6
log.LogSuppressed=1 ; Suppress log spam

; ==========================================================================================
;       LOG SUPPRESSION (v3.1) - Reduces Disk I/O
; ==========================================================================================
[Core.Log]
Global=off
LogTemp=off
LogOnline=off
LogAudio=off
LogInit=off
LogRender=off
LogStreaming=off
LogMemory=off
LogPakFile=off
LogNet=off
LogNetPackageMap=off
LogAndroid=off
LogVulkan=off
LogShaderCompilers=off
LogPSO=off
LogRHI=off
LogEditorAnalytics=off
LogHMD=off
LogConfig=off
LogStats=off
LogHLOD=off
LogGarbage=off
LogTexture=off
LogMaterial=off
LogLightRendering=off
LogRenderer=off
LogOcclusion=off
LogNavMesh=off
LogLoad=off
LogAssetRegistry=off
